{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useEffect, createContext } from \"react\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { initializeApp } from \"firebase/app\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { getAuth, signInWithEmailAndPassword } from \"firebase/auth\";\nimport { firebaseConfig } from \"../../config/firebase\";\nimport { GetStorage } from \"../../common/constants/storage\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport var AuthenticatedContext = createContext({});\nexport function AuthenticatedProvider(_ref) {\n  var children = _ref.children;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isLogged = _useState2[0],\n      setIsLogged = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      user = _useState4[0],\n      setUser = _useState4[1];\n\n  var _useState5 = useState(\"Senha ou login incorreto\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      errorLogin = _useState6[0],\n      setErrorLogin = _useState6[1];\n\n  var app = initializeApp(firebaseConfig);\n  var auth = getAuth(app);\n\n  function signIn(_x, _x2) {\n    return _signIn.apply(this, arguments);\n  }\n\n  function _signIn() {\n    _signIn = _asyncToGenerator(function* (email, password) {\n      if (!email || !password) {\n        return Alert.alert(\"Login\", \"Informe o e-mail e a senha\");\n      }\n\n      setIsLogged(true);\n      signInWithEmailAndPassword(auth, email, password).then(function () {\n        var _ref2 = _asyncToGenerator(function* (account) {\n          if (account.user) {\n            yield AsyncStorage.setItem(GetStorage.USER_AUTHENTICATED, JSON.stringify(account.user));\n            setUser(account.user);\n          }\n        });\n\n        return function (_x3) {\n          return _ref2.apply(this, arguments);\n        };\n      }()).catch(function (error) {\n        var code = error.code;\n\n        if (code === \"auth/user-not-found\" || code === \"auth/wrong-password\") {\n          return setErrorLogin(errorLogin);\n        } else {\n          return Alert.alert(\"Login\", \"Não foi possível realizar o login\");\n        }\n      }).finally(function () {\n        return setIsLogged(false);\n      });\n    });\n    return _signIn.apply(this, arguments);\n  }\n\n  function loadUserStorageData() {\n    return _loadUserStorageData.apply(this, arguments);\n  }\n\n  function _loadUserStorageData() {\n    _loadUserStorageData = _asyncToGenerator(function* () {\n      setIsLogged(true);\n      var storedUser = yield AsyncStorage.getItem(GetStorage.USER_AUTHENTICATED);\n\n      if (storedUser) {\n        var userData = JSON.parse(storedUser);\n        setUser(userData);\n      }\n\n      setIsLogged(false);\n    });\n    return _loadUserStorageData.apply(this, arguments);\n  }\n\n  function signOut() {\n    return _signOut.apply(this, arguments);\n  }\n\n  function _signOut() {\n    _signOut = _asyncToGenerator(function* () {\n      yield auth.signOut();\n      yield AsyncStorage.removeItem(GetStorage.USER_AUTHENTICATED);\n      yield AsyncStorage.removeItem(GetStorage.USER_FILTERED);\n      yield AsyncStorage.removeItem(GetStorage.MEMBERS_FILTERED);\n      setUser(null);\n    });\n    return _signOut.apply(this, arguments);\n  }\n\n  useEffect(function () {\n    loadUserStorageData();\n  }, []);\n  return _jsx(AuthenticatedContext.Provider, {\n    value: {\n      signIn: signIn,\n      isLogged: isLogged,\n      user: user,\n      signOut: signOut,\n      errorLogin: errorLogin\n    },\n    children: children\n  });\n}","map":{"version":3,"names":["React","useState","useEffect","createContext","initializeApp","AsyncStorage","getAuth","signInWithEmailAndPassword","firebaseConfig","GetStorage","AuthenticatedContext","AuthenticatedProvider","children","isLogged","setIsLogged","user","setUser","errorLogin","setErrorLogin","app","auth","signIn","email","password","Alert","alert","then","account","setItem","USER_AUTHENTICATED","JSON","stringify","catch","error","code","finally","loadUserStorageData","storedUser","getItem","userData","parse","signOut","removeItem","USER_FILTERED","MEMBERS_FILTERED"],"sources":["C:/Users/felip/AppIbavNovo/app/src/contexts/Auth/index.tsx"],"sourcesContent":["import React, { useState, useEffect, createContext } from \"react\";\r\nimport { Alert } from \"react-native\";\r\nimport { initializeApp } from \"firebase/app\";\r\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\r\nimport { getAuth, signInWithEmailAndPassword, User } from \"firebase/auth\";\r\n\r\nimport { firebaseConfig } from \"../../config/firebase\";\r\n\r\nimport { IAuthContextData, IAuthProviderProps } from \"./types\";\r\nimport { GetStorage } from \"../../common/constants/storage\";\r\n\r\nexport const AuthenticatedContext = createContext({} as IAuthContextData);\r\n\r\nexport function AuthenticatedProvider({ children }: IAuthProviderProps) {\r\n  const [isLogged, setIsLogged] = useState(false);\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [errorLogin, setErrorLogin] = useState<string>(\r\n    \"Senha ou login incorreto\"\r\n  );\r\n\r\n  const app = initializeApp(firebaseConfig);\r\n  const auth = getAuth(app);\r\n\r\n  async function signIn(email: string, password: string) {\r\n    if (!email || !password) {\r\n      return Alert.alert(\"Login\", \"Informe o e-mail e a senha\");\r\n    }\r\n\r\n    setIsLogged(true);\r\n\r\n    signInWithEmailAndPassword(auth, email, password)\r\n      .then(async (account) => {\r\n        if (account.user) {\r\n          await AsyncStorage.setItem(\r\n            GetStorage.USER_AUTHENTICATED,\r\n            JSON.stringify(account.user)\r\n          );\r\n          setUser(account.user);\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        const { code } = error;\r\n\r\n        if (code === \"auth/user-not-found\" || code === \"auth/wrong-password\") {\r\n          return setErrorLogin(errorLogin);\r\n        } else {\r\n          return Alert.alert(\"Login\", \"Não foi possível realizar o login\");\r\n        }\r\n      })\r\n      .finally(() => setIsLogged(false));\r\n  }\r\n\r\n  async function loadUserStorageData() {\r\n    setIsLogged(true);\r\n\r\n    const storedUser = await AsyncStorage.getItem(\r\n      GetStorage.USER_AUTHENTICATED\r\n    );\r\n\r\n    if (storedUser) {\r\n      const userData = JSON.parse(storedUser) as User;\r\n\r\n      setUser(userData);\r\n    }\r\n\r\n    setIsLogged(false);\r\n  }\r\n\r\n  async function signOut() {\r\n    await auth.signOut();\r\n    await AsyncStorage.removeItem(GetStorage.USER_AUTHENTICATED);\r\n    await AsyncStorage.removeItem(GetStorage.USER_FILTERED);\r\n    await AsyncStorage.removeItem(GetStorage.MEMBERS_FILTERED);\r\n\r\n    setUser(null);\r\n  }\r\n\r\n  useEffect(() => {\r\n    loadUserStorageData();\r\n  }, []);\r\n\r\n  return (\r\n    <AuthenticatedContext.Provider\r\n      value={{ signIn, isLogged, user, signOut, errorLogin }}\r\n    >\r\n      {children}\r\n    </AuthenticatedContext.Provider>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}